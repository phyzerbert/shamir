define([],function(){function t(t,n,e,o,r){this.app_id=t,this.user_id=n,this.challenge=o,this.control_flows=this.normalizeControlFlows(e,r)}function n(t,n){function e(t,n){return t.type===n||n&&n.startsWith("otp.")&&"otp"===t.type&&t.channels[0].type===n.split(".")[1]}return t.map(function(t){return(t.locked||"unregistered"===t.status)&&(t.disabled=!0),e(t,n)&&(t.isDefault=!0),t})}return t.prototype.normalizeControlFlows=function(t,e){return t.map(function(t){var o=Object.assign({},t);return"authentication"==o.type&&(o.methods=o.methods.flatMap(function(t){if("otp"==t.type){var n=t;return t.channels.map(function(t){var e=Object.assign({},n);return e.assertion_id=t.assertion_id,e.channels=[t],"none"==t.type||e.otp_format||Object.keys(t.targets).length||(e.disabled=!0),e})}return t}),o.methods=n(o.methods,e)),o})},t.prototype.completeCurrentControlFlowStep=function(){this.control_flows.shift()},t.prototype.getCurrentControlFlowStep=function(){return this.control_flows[0]},{ControlFlowContext:t,markDisabledAndDefaultMethods:n}});