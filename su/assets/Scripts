(function(n,t,i){"use strict";t.module("ngBusy.interceptor",[]).provider("busyInterceptor",function(){this.$get=["$rootScope","$q",function(n,t){function f(){i=r=0}function u(t){t.config.notBusy||(n.$broadcast("busy.end",{url:t.config.url,name:t.config.name,remaining:i-++r}),r>=i&&f())}var i=0,r=0;return{outstanding:function(){return i-r},request:function(r){return r.notBusy||(n.$broadcast("busy.begin",{url:r.url,name:r.name}),i++),r||t.when(r)},response:function(n){return u(n),n},responseError:function(n){return u(n),t.reject(n)}}}]}).config(["$httpProvider",function(n){n.interceptors.push("busyInterceptor")}]);t.module("ngBusy.busy",[]).directive("busy",["$parse","$timeout",function(n,r){return{restrict:"A",tranclude:!0,scope:{},controller:["$scope",function(n){this.setBusyMessageElement=function(t){n.busyMessageElement=t}}],link:function(u,f,e){var o;e.$observe("busy",function(n){u.busyMessage=n});e.$observe("busyWhenUrl",function(n){u.busyWhenUrl=n});e.$observe("busyWhenName",function(n){u.busyWhenName=n});e.$observe("busyAddClasses",function(n){u.busyAddClasses=n});e.$observe("busyRemoveClasses",function(n){u.busyRemoveClasses=n});e.$observe("busyDisabled",function(i){var r=n(i)(u);u.busyDisabled=t.isDefined(r)?r:!0});e.$observe("notBusyWhenUrl",function(n){u.notBusyWhenUrl=n});e.$observe("notBusyWhenName",function(n){u.notBusyWhenName=n});e.$observe("notBusyAddClasses",function(n){u.notBusyAddClasses=n});e.$observe("notBusyRemoveClasses",function(n){u.notBusyRemoveClasses=n});e.$observe("notBusyDisabled",function(i){var r=n(i)(u);u.notBusyDisabled=t.isDefined(r)?r:!1});var s=function(n,t){var i=new Date,r;i.setTime(i.getTime()+864e5);r="expires="+i.toUTCString();document.cookie=n+"="+t+";"+r+";path=/"},c=function(n){var i="; "+document.cookie,t=i.split("; "+n+"=");if(t.length==2)return t.pop().split(";").shift()},h=function(){try{o=c("SuppressSpinner")}catch(n){s("SuppressSpinner","false")}return o};u.isBusyFor=function(n,t){var i;return u[i=t?"busyWhenName":"notBusyWhenName"]?!!n.name&&!!n.name.match(u[i]):u[i=t?"busyWhenUrl":"notBusyWhenUrl"]?!!n.url&&!!n.url.match(u[i]):t===!0||n.remaining<=0};u.$on("busy.begin",function(n,t){var s,e,o;!u.busy&&u.isBusyFor(t,!0)&&(u.originalContent=f.html(),u.busyDisabled&&r(function(){f.attr("disabled",!0)}),s=u.busyMessageElement?u.busyMessageElement.clone():null,(s||u.busyMessage)&&f.html("").append(s||u.busyMessage),e=h(),(e===i||e===null||e==""||e=="false")&&(f.removeClass(u.busyRemoveClasses).addClass(u.busyAddClasses),o=document.getElementById("spinnerLoader"),o&&(o.setAttribute("tabindex","0"),o.focus())),u.busy=!0)});u.$on("busy.end",function(n,t){if(u.busy&&u.isBusyFor(t)){u.originalContent&&f.html(u.originalContent);f.attr("disabled",u.notBusyDisabled===!0);var r=h();if(r===i||r===null||r==""||r=="false")f.removeClass(u.notBusyRemoveClasses).addClass(u.notBusyAddClasses);else try{s("SuppressSpinner","false")}catch(e){}u.busy=!1}})}}}]).directive("busyMessage",function(){return{restrict:"AE",transclude:!0,require:"^busy",template:"",replace:!0,compile:function(n,t,i){return function(n,t,r,u){u.setBusyMessageElement(i(n,function(){}))}}}});t.module("ngBusy",["ngBusy.interceptor","ngBusy.busy"])})(window,window.angular)