$(document).ready(function(){var prefix="https://www.usbank.com/"; var outdatedPath={'chrome': 'https://www.google.com/intl/en/chrome/browser/desktop/index.html', 'ff': 'https://www.mozilla.org/en-US/firefox/new/', 'ie': 'https://support.microsoft.com/en-us/products/internet-explorer', 'safari': 'https://support.apple.com/downloads/Safari_1_2', 'outdated': 'https://www.usbank.com/splash/software-and-browser-requirements.html'}; var supported=browserUnsupported(); var optimal=true; var blocked=true; if (supported){optimal=browserOptimal();}if (supported && optimal){blocked=browserBlocked();}if (optimal && supported){loadSupportedJS();}checkIE(); function checkIE(){var browserDetails=getBrowserDetails(); var browserName=browserDetails[0]; var browserVersion=Number(browserDetails[1]); var browser=navigator.userAgent; if ((browserName=="Microsoft Internet Explorer") || (browser.indexOf('MSIE') > -1)){if (browserVersion < 9){tagIE();}}}$("#browserOptimalUrl").on('click', function(e){e.preventDefault(); var url=$('#browserOptimalUrl').attr('data-ext-link'); $("#speedBumpModal .continue").attr('val', url);}); $("#browserUnsupportedUrl").on('click', function(e){e.preventDefault(); var url=$('#browserUnsupportedUrl').attr('data-ext-link'); $("#speedBumpModal .continue").attr('val', url);}); $("#browserBlockedUrl").on('click', function(e){e.preventDefault(); var url=$('#browserBlockedUrl').attr('data-ext-link'); $("#speedBumpModal .continue").attr('val', url);}); function showOptimalMsg(b, bv){var url=getUrl(b); $("#optimalAlert").removeClass('hidden').show(); $("#browserOptimalUrl").attr('data-ext-link', url); $("#speedBumpModal .continue").attr('val', url);}function showUnsupportedMsg(b, bv){var url=getUrl(b); $("#unsupportedAlert").removeClass('hidden').show(); $("#browserUnsupportedUrl").attr('data-ext-link', url); $("#speedBumpModal .continue").attr('val', url);}function showBlockedMsg(b, bv){var url=getUrl(b); $("#blockedAlert").removeClass('hidden').show(); $("#browserBlockedUrl").attr('data-ext-link', url); $("#speedBumpModal .continue").attr('val', url);}function getUrl(b){switch (b){case 'Microsoft Internet Explorer': return outdatedPath.ie; break; case 'Firefox': return outdatedPath.ff; break; case 'Safari': return outdatedPath.safari; break; case 'Chrome': return outdatedPath.chrome; break; case 'Silk': case 'Opera': case 'Puffin': return outdatedPath.outdated; break;}return;}function tagIE(){$("#content5 .circle-images").addClass("ie"); $(".alert").addClass("ie"); $("#speedBumpModal").addClass("ie");}function browserUnsupported(){var browserDetails=getBrowserDetails(); var browserName=browserDetails[0]; var browserVersion=Number(browserDetails[1]); var browser=navigator.userAgent; if (browserName=="Microsoft Internet Explorer"){if ((browserVersion==9) || (browserVersion==10)){showUnsupportedMsg(browserName, browserVersion); return false;}return true;}else if (browser.indexOf('MSIE') > -1){if ((browserVersion==9) || (browserVersion==10)){showUnsupportedMsg("Microsoft Internet Explorer", browserVersion); return false;}return true;}else if (browserName=="Firefox"){if ((browserVersion > 35) && (browserVersion < 52)){showUnsupportedMsg(browserName, browserVersion); return false;}}else if (browserName=="Safari"){if ((browserVersion==8) || (browserVersion==9)){showUnsupportedMsg(browserName, browserVersion); return false;}}else if (browserName=="Chrome"){if ((browserVersion > 35) && (browserVersion < 57)){showUnsupportedMsg(browserName, browserVersion); return false;}}else if (browserName=="Silk"){showUnsupportedMsg(browserName, browserVersion); return false;}else if (browserName=="Opera"){showUnsupportedMsg(browserName, browserVersion); return false;}else if (browserName=="Puffin"){showUnsupportedMsg(browserName, browserVersion); return false;}else{return true;}return true;}function browserOptimal(){var browserDetails=getBrowserDetails(); var browserName=browserDetails[0]; var browserVersion=Number(browserDetails[1]); if (browserName=="Microsoft Internet Explorer"){if ((browserVersion==7) || (browserVersion==8)){showOptimalMsg(browserName, browserVersion); return false;}return true;}else if (browserName=="Firefox"){if (browserVersion < 36 && browserVersion > 23){showOptimalMsg(browserName, browserVersion); return false;}}else if (browserName=="Safari"){if ((browserVersion < 8) && (browserVersion > 6)){showOptimalMsg(browserName, browserVersion); return false;}}else if (browserName=="Chrome"){if ((browserVersion < 36) && (browserVersion > 29)){showOptimalMsg(browserName, browserVersion); return false;}}else{return true;}return true;}function browserBlocked(){var browserDetails=getBrowserDetails(); var browserName=browserDetails[0]; var browserVersion=Number(browserDetails[1]); if (browserName=="Microsoft Internet Explorer"){if (browserVersion < 7){showBlockedMsg(browserName, browserVersion); return false;}}else if (browserName=="Firefox"){if (browserVersion < 24){showBlockedMsg(browserName, browserVersion); return false;}}else if (browserName=="Safari"){if (browserVersion < 6){showBlockedMsg(browserName, browserVersion); return false;}}else if (browserName=="Chrome"){if (browserVersion < 30){showBlockedMsg(browserName, browserVersion); return false;}}else{return true;}return true;}function getBrowserDetails(){var nVer=navigator.appVersion; var nAgt=navigator.userAgent; var browserName=navigator.appName; var fullVersion='' + parseFloat(navigator.appVersion); var majorVersion=parseInt(navigator.appVersion, 10); var nameOffset, verOffset, ix; var ieBro=ie11(); var ieVersion=ieBro; if (Number(ieVersion) > 10){return ["Microsoft Internet Explorer", ieVersion];}else if ((verOffset=nAgt.indexOf("MSIE")) !=-1){browserName="Microsoft Internet Explorer"; fullVersion=nAgt.substring(verOffset + 5);}else if ((verOffset=nAgt.indexOf("Chrome")) !=-1){browserName="Chrome"; fullVersion=nAgt.substring(verOffset + 7); if ((verOffset=nAgt.indexOf("Version")) !=-1) fullVersion=nAgt.substring(verOffset + 8);}else if ((verOffset=nAgt.indexOf("Safari")) !=-1){browserName="Safari"; fullVersion=nAgt.substring(verOffset + 7); if ((verOffset=nAgt.indexOf("Version")) !=-1) fullVersion=nAgt.substring(verOffset + 8);}else if ((verOffset=nAgt.indexOf("Firefox")) !=-1){browserName="Firefox"; fullVersion=nAgt.substring(verOffset + 8);}else if ((verOffset=nAgt.indexOf("Silk")) !=-1){browserName="Silk"; fullVersion=nAgt.substring(verOffset + 8);}else if ((verOffset=nAgt.indexOf("Opera")) !=-1){browserName="Opera"; fullVersion=nAgt.substring(verOffset + 8);}else if ((verOffset=nAgt.indexOf("Puffin")) !=-1){browserName="Puffin"; fullVersion=nAgt.substring(verOffset + 8);}else{browserName=""; fullVersion=0;}if (Number(ieVersion) > 10){}else{if ((ix=fullVersion.indexOf(";")) !=-1) fullVersion=fullVersion.substring(0, ix); if ((ix=fullVersion.indexOf(" ")) !=-1) fullVersion=fullVersion.substring(0, ix);}majorVersion=parseInt('' + fullVersion, 10); if (isNaN(majorVersion)){fullVersion='' + parseFloat(navigator.appVersion); majorVersion=parseInt(navigator.appVersion, 10);}return [browserName, majorVersion];}function ie11(){var rv=-1; if (navigator.appName=='Microsoft Internet Explorer'){var ua=navigator.userAgent; var re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"); if (re.exec(ua) !=null) rv=parseFloat(RegExp.$1);}else if (navigator.appName=='Netscape'){var ua=navigator.userAgent; var re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"); if (re.exec(ua) !=null) rv=parseFloat(RegExp.$1);}return Number(rv);}function loadSupportedJS(){if (typeof define==='function' && define.amd){require(['ScrollMagic', 'TweenMax', "animation", "ScrollToPlugin"], function(ScrollMagic, TweenMax, animation, ScrollToPlugin){var controller=new ScrollMagic.Controller({globalSceneOptions:{triggerHook: "onLeave", duration: "150%", debug: false}}); new ScrollMagic.Scene({triggerElement: "#content1"}).setTween("#content1 > div",{y: '80%', ease: Linear.easeNone}).addTo(controller);});}else{$.getScript(prefix + "assets/lib/scrollMagic/js/ScrollMagic.js", function(){$.getScript(prefix + "assets/lib/scrollMagic/js/TweenMax.min.js", function(){$.getScript(prefix + "assets/lib/scrollMagic/js/animation.gsap.js", function(){$.getScript(prefix + "assets/lib/scrollMagic/js/ScrollToPlugin.min.js", function(){var controller=new ScrollMagic.Controller({globalSceneOptions:{triggerHook: "onLeave", duration: "150%", debug: false}}); new ScrollMagic.Scene({triggerElement: "#content1"}).setTween("#content1 > div",{y: '80%', ease: Linear.easeNone}).addTo(controller);});});});});}}});$(document).ready(function(){$(".firstLevelMegaNavULDesktop .yamm-fw").each(function(i){var navContent=$('#megaNav' + i).find('.textSpan').text(); $('#megaNav' + i + ' a.dropdown-toggle').attr('aria-label', navContent + ', shows content');}); $("#navSection").find('.loginButton').attr('aria-label', 'login, shows content'); $("#navSection").on('shown.bs.dropdown', function(event){var dropdown=$(event.target); dropdown.find('.loginButton').attr('aria-label', 'log in, hides content');}); $("#navSection").on('hide.bs.dropdown', function(event){var dropdown=$(event.target); dropdown.find('.loginButton').attr('aria-label', 'log in, shows content');}); $('#navbar-collapse-grid').on('shown.bs.dropdown', function(){var navName=$('#navbar-collapse-grid').find('.open a .textSpan').text(); $(this).find('.open').addClass("arealabel"); $(this).find('.open .dropdown-toggle').attr('aria-label', navName + ', hides content');}); $('#navbar-collapse-grid').on('hide.bs.dropdown', function(){var navName=$('#navbar-collapse-grid').find('.arealabel a .textSpan').text(); $(this).find('.arealabel .dropdown-toggle').attr('aria-label', navName + ', shows content'); $(this).find('.dropdown').removeClass("arealabel");});});$(document).ready(function(){var window_height=$(window).height(); var window_width=$(window).width(); var base_url="https://onlinebanking.usbank.com"; var hasImg=false; navInit(); fontInit(); imageInit(); iframeInit(); cleanUpAriaTag(); var $body=$("html,body"); var $content1=$("#content1"); if (typeof $content1=="undefined"){$content1=$("#content1_80vh");}if (typeof $content1=="undefined"){$content1=$("#content1_70vh");}var $ada_sCode=$("#ADA"); var $content2=$("#content2"); var $content3=$("#content3"); var $content4=$("#content4"); var $content5=$("#content5"); var $card_image=$(".card-image"); var $tabs=$(".tab-contents"); var $content1_background=$(".content1-parallex"); var $content4_background=$(".content4-parallex"); var $docwindow=$("#content1"); var scrollTop=$(window).scrollTop(); var content1=0; var content2=$content2.offset().top; var content3=$content3.offset().top; var content4=$content4.offset().top; var content5=$content5.offset().top; var footer=0; var distance_content1=(content1 - scrollTop); var distance_content2=(content2 - scrollTop); var distance_content3=(content3 - scrollTop); var distance_content4=(content4 - scrollTop); var distance_content5=(content5 - scrollTop); var $btn_wrapper=$(".btn-group-wrapper"); var $tabs=$(".tab-content-wrapper"); var $tab1=$(".menu1"); var $tab2=$(".menu2"); var $tab3=$(".menu3"); var $tab4=$(".menu4"); var $tab5=$(".menu5"); var $tip1=$("svg#menu1-tip"); var $tip2=$("svg#menu2-tip"); var $tip3=$("svg#menu3-tip"); var $tip4=$("svg#menu4-tip"); var $tip5=$("svg#menu5-tip"); var $tabp; var $mobiIndex=$("#mobi_index"); var tabs=0; var didSection2Show=false; var isFirstTab=true; var isIframe=true; var isLoginWidgetShow=true; var didScroll=false; var prev_pos=0; var auto_scroll_down=-200; var auto_scroll_up=9999999999; var i=0; $card_image.hide(); $(".section-content-wrapper").find("h4").hide(); $(".section-content-wrapper").find("p").hide(); $(".section-content-wrapper").find("button").hide(); $content2.find("h3").hide(); $content2.find(".special-p").hide(); $content2.find(".btn-wrapper").hide(); $content4.find("p").hide(); $content4.find("h2").hide(); $content4.find(".link-wrapper").hide(); $content5.find(".header-wrapper").hide(); $content5.find(".section1").hide(); $content5.find(".section2").hide(); $content5.find(".section3").hide(); $(".tab-images").hide(); $tabs.hide(); $(document).on("mobileinit", function(){$.mobile.ajaxEnabled=false; $.mobile.loadingMessage=false;}); $(window).on("scroll", function(){scrollTop=$(window).scrollTop(); content1=0; content2=$content2.offset().top; content3=$content3.offset().top; content4=$content4.offset().top; content5=$content5.offset().top; distance_content1=(content1 - scrollTop); distance_content2=(content2 - scrollTop); distance_content3=(content3 - scrollTop); distance_content4=(content4 - scrollTop); distance_content5=(content5 - scrollTop); distance_footer=(footer - scrollTop); animationTrigger();});  $(".btn-group-wrapper").on("click", ".box", function(e){var id=$(this).attr("id"); var tar="." + id; if (id.length < 8){var number=id.substring(4);}else{var number=id.substring(8); tar=".menu" + number;}tipColorChanger(number - 1); menuStyleChanger(number - 1); $('.tpanel').attr("aria-hidden", "true"); setFeatureItemText(number - 1); section2_animation($(tar)); $tabp=new tabpanel("content2", false); return false;}); $body.on("keydown", function(e){if (e.keyCode==9 && isFirstTab){isFirstTab=false; setFeatureItemText(0); section2_animation($tab1, false); section3_animation(); section4_animation(); section5_animation();}return 0;}); $body.on("swipeleft", function(e){if (isFirstTab && !didSection2Show){isFirstTab=false; setFeatureItemText(0); section2_animation($tab1, false); section3_animation(); section4_animation(); section5_animation();}return 0;}); $body.on("swiperight", function(e){if (isFirstTab && !didSection2Show){isFirstTab=false; setFeatureItemText(0); section2_animation($tab1, false); section3_animation(); section4_animation(); section5_animation();}return 0;}); $(".scroll-btn-trigger").on("click", function(e){e.preventDefault(); $("html,body").animate({scrollTop: $("#content2").offset().top}, 800);}); function cleanUpAriaTag(){$("li.megaNavItemColumnLink a").removeAttr('aria-label'); $(".firstLevelMegaNavDesktopThirdCol .globalNav a").removeAttr('aria-label');}function navInit(){var img=new Image(); img.src="home-etc/clientlib-site/images/svg/circle_button_red_hover_36_36.svg";}$(window).resize(function(){imageInit(); fontInit();}); function toggleCheckbox($tar){if ($tar.hasClass('checked')){$tar.removeClass('checked'); $tar.addClass("white-bk");}else{$tar.removeClass("white-bk"); $tar.addClass('checked');}}function iframeInit(){var $iframe=$(".iframe-container"); var str="<iframe src='" + base_url + "/Auth/Login?isWidget=true&uxRefresh=true' class='animation_level_075 element_slide_up_fade_in visible-md visible-lg' title='Log In'></iframe>";$iframe.append(str); return true;}function isMobile(){if (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i)){return true;}else{return false;}}function fontInit(){var $target=$('.section-content-wrapper-exception'); var divHeight=$target.height(); var screenHeight=$(window).height(); var screenWidth=getScreenWidth(); if (screenWidth >=750){if (!$target.hasClass('bounded') && (divHeight > screenHeight - (114 + screenHeight * 0.1))){$target.addClass('bounded');}}else{$target.removeClass('bounded');}}function imageInit(){var w_size=window.innerWidth; if (w_size > 767){if (!hasImg){try{$('.card-image').css({'background': 'url(./assets/images/homepage-area3-photo-brand.jpg) no-repeat center center', 'background-position': 'center center', 'background-size': 'contain'}); $('.section1 .hidden-xs').append('<img alt="" src="./assets/images/desk_woman_smile.jpg" class="img-medium-size center-block img-circle" aria-hidden="true" focusable="false">'); $('.section2 .hidden-xs').append('<img alt="" src="./assets/images/father_daughter_bills.jpg" class="img-medium-size center-block img-circle" aria-hidden="true" focusable="false">'); $('.section3 .hidden-xs').append('<img alt="" src="./assets/images/community_possible_stefondiggs.jpg" class="img-medium-size center-block img-circle" aria-hidden="true" focusable="false">'); hasImg=true;}catch (e){console.log("err 1 " + e);}}}else{$(".card-image").css('background', ''); $('.section1 img').remove(); $('.section2 img').remove(); $('.section3 img').remove(); hasImg=false;}}function setFeatureItemText(i){var txt=getFeatureItemText(i + 1); $mobiIndex.empty().append(txt);}function getFeatureItemText(i){return "featured item " + i + " of 5";}var $menus=[$tab1, $tab2, $tab3, $tab4, $tab5]; var $tips=[$tip1, $tip2, $tip3, $tip4, $tip5]; $("#content2").on("swipeleft", function(event){tabLeft(event);}); $("#content2").on("swiperight", function(event){tabRight(event);}); $("#content2").on("click", ".mobox", function(e){e.preventDefault(); $('.tpanel').attr("aria-hidden", "true"); var id=$(this).attr('id'); i=parseInt(id.substring(5)); mobileBtnColorChanger(i); tipColorChanger(i); setFeatureItemText(i); section2_animation($menus[i], true);}); $("#content2").on("click", ".arrow-left", function(event){tabLeft(event);}); $("#content2").on("click", ".arrow-right", function(event){tabRight(event);}); function mobileBtnColorChanger(i){var $tar=$("#mobi_box" + i); $(".active-mobile-box").attr('class', 'mobile-box'); $tar.attr('class', 'mobile-box active-mobile-box');}function getScreenWidth(){return $(window).width();}function tabLeft(event){event.preventDefault(); $('.tpanel').attr("aria-hidden", "true"); if (i==0){i=4;}else{i--;}menuStyleChanger(i); mobileBtnColorChanger(i); tipColorChanger(i); setFeatureItemText(i); section2_animation($menus[i], true);}function tabRight(event){event.preventDefault(); $('.tpanel').attr("aria-hidden", "true"); if (i==4){i=0;}else{i++;}menuStyleChanger(i); mobileBtnColorChanger(i); tipColorChanger(i); setFeatureItemText(i); section2_animation($menus[i], true);}function menuStyleChanger(i){var tar_box="#menu" + (i + 1); $(".box").removeClass("active-box"); $(tar_box).addClass("active-box");}function switchActiveState($curTab, $newTab){var curtab_id=$curTab.attr("id"); var newtab_id=$newTab.attr("id"); var curtab_tip="#" + curtab_id + "-tip"; var newtab_tip="#" + newtab_id + "-tip"; var $curTip=$(curtab_tip); var $newTip=$(newtab_tip); var $curtab=$("#" + curtab_id); var $newtab=$("#" + newtab_id); var cur_classes=$curTip.attr("class"); var new_classes=$newTip.attr("class"); $('.tpanel').attr("aria-hidden", "true"); if (cur_classes.indexOf("active-tip") > -1){var str=cur_classes.substring(0, cur_classes.indexOf("active-tip")); $curTip.attr("class", str);}$newTip.attr("class", new_classes + " active-tip"); $curtab.removeClass("active-box"); $newtab.addClass("active-box"); section2_animation($("." + newtab_id), true); return false;}function tipColorChanger(i){for (var x=0; x < $tips.length; x++){if (x < 3){if (x==i){$tips[x].attr("class", "tip left active-tip");}else{$tips[x].attr("class", "tip left");}}else{if (x==i){$tips[x].attr("class", "tip right active-tip");}else{$tips[x].attr("class", "tip right");}}}}function section2_animation($target, focusState){if (didSection2Show==false){new tabpanel("content2", false);}didSection2Show=true; $target.find("h3").addClass("element_slide_up_fade_in"); $target.find("h3").show(); $target.find("p").addClass("element_slide_up_fade_in"); $target.find("p").show(); $(".tab-images").addClass("element_slide_up_fade_in"); $(".tab-images").show(); $target.find(".btn-wrapper").addClass("element_slide_up_fade_in"); $target.find(".btn-wrapper").show(); $target.attr("aria-hidden", "false"); $target.find("h3").removeAttr('style'); $target.find("p").removeAttr('style'); $(".tab-images").removeAttr('style'); $target.find(".btn-wrapper").removeAttr('style'); if (focusState){$target.find("p").focus();}}function section3_animation(){$card_image.addClass("element_slide_right_fade_in"); $card_image.show(); $content3.find(".section-content-wrapper").find("h4").addClass("element_slide_left_fade_in"); $content3.find(".section-content-wrapper").find("h4").show(); $content3.find(".section-content-wrapper").find("p").addClass("element_slide_left_fade_in"); $content3.find(".section-content-wrapper").find("p").show(); $content3.find(".section-content-wrapper").find("button").addClass("element_slide_left_fade_in"); $content3.find(".section-content-wrapper").find("button").show(); $content3.find(".section-content-wrapper").find("h4").removeAttr('style'); $content3.find(".section-content-wrapper").find("p").removeAttr('style'); $content3.find(".section-content-wrapper").find("button").removeAttr('style');}function section4_animation(){$content4.find("p").addClass("element_slide_up_fade_in"); $content4.find("p").show(); $content4.find("h2").addClass("element_slide_up_fade_in"); $content4.find("h2").show(); $content4.find(".link-wrapper").addClass("element_slide_up_fade_in"); $content4.find(".link-wrapper").show(); $content4.find("p").removeAttr('style'); $content4.find("h2").removeAttr('style'); $content4.find(".link-wrapper").removeAttr('style');}function section5_animation(){$content5.find("h2").addClass("element_slide_up_fade_in"); $content5.find("p").addClass("element_slide_up_fade_in"); $content5.find("button").addClass("element_slide_up_fade_in"); $content5.find("h2").show(); $content5.find("p").show(); $content5.find("button").show(); $content5.find("h2").removeAttr('style'); $content5.find("p").removeAttr('style'); $content5.find("button").removeAttr('style'); $content5.find(".header-wrapper").addClass("element_slide_up_fade_in"); $content5.find(".header-wrapper").show(); $content5.find(".header-wrapper").removeAttr('style'); $content5.find(".section1").addClass("element_slide_up_fade_in"); $content5.find(".section1").show(); $content5.find(".section2").addClass("element_slide_up_fade_in"); $content5.find(".section2").show(); $content5.find(".section3").addClass("element_slide_up_fade_in"); $content5.find(".section3").removeAttr('style'); $content5.find(".section1").removeAttr('style'); $content5.find(".section2").removeAttr('style'); $content5.find(".section3").removeAttr('style');}function animationTrigger(){try{if (distance_content2 < 506 && !$content2.find("h3").hasClass("element_slide_up_fade_in")){setFeatureItemText(0); section2_animation($tab1, true);}if (distance_content3 < 652.640625 && !$card_image.hasClass("element_slide_right_fade_in")){section3_animation();}if (distance_content4 < 759.515625 && !$content4.find("h1").hasClass("element_slide_up_fade_in")){section4_animation();}if (distance_content5 < 700.515625 && !$content5.find("h2").hasClass("element_slide_up_fade_in")){section5_animation();}}catch (e){console.log(e);}return false;}function newPosition(pos, adj, rat, dir){return (dir * (pos - adj) * rat) + "px";}function keyCodes(){this.tab=9; this.enter=13; this.esc=27; this.space=32; this.pageup=33; this.pagedown=34; this.end=35; this.home=36; this.left=37; this.up=38; this.right=39; this.down=40;}function tabpanel(id, accordian){this.panel_id=id; this.accordian=accordian; this.$panel=$('#' + id); this.keys=new keyCodes(); this.$tabs=this.$panel.find('.tab'); this.$panels=this.$panel.children('.tpanel'); this.bindHandlers(); this.init(); return this;}; tabpanel.prototype.init=function(){var $tab; this.$panels.attr('aria-hidden', 'true'); $tab=this.$tabs.filter('[aria-selected="true"]'); if ($tab==undefined){$tab=this.$tabs.first();}this.$panel.find('#' + $tab.attr('aria-controls')).attr('aria-hidden', 'false');}; tabpanel.prototype.switchTabs=function($curTab, $newTab){$curTab.removeClass('focus'); $curTab.attr('tabindex', '-1').attr('aria-selected', 'false'); $newTab.attr('aria-selected', 'true'); if (this.accordian==false){this.$panel.find('#' + $curTab.attr('aria-controls')).attr('aria-hidden', 'true'); this.$panel.find('#' + $newTab.attr('aria-controls')).attr('aria-hidden', 'false');}switchActiveState($curTab, $newTab); $newTab.attr('tabindex', '0'); $newTab.focus();}; tabpanel.prototype.togglePanel=function($tab){$panel=this.$panel.find('#' + $tab.attr('aria-controls')); if ($panel.attr('aria-hidden')=='true'){$panel.slideDown(100); $panel.attr('aria-hidden', 'false');}else{$panel.slideUp(100); $panel.attr('aria-hidden', 'true');}}; tabpanel.prototype.bindHandlers=function(){var thisObj=this; this.$tabs.keydown(function(e){return thisObj.handleTabKeyDown($(this), e);}); this.$tabs.keypress(function(e){return thisObj.handleTabKeyPress($(this), e);}); this.$tabs.click(function(e){return thisObj.handleTabClick($(this), e);}); this.$tabs.focus(function(e){return thisObj.handleTabFocus($(this), e);}); this.$tabs.blur(function(e){return thisObj.handleTabBlur($(this), e);}); this.$panels.keydown(function(e){return thisObj.handlePanelKeyDown($(this), e);}); this.$panels.keypress(function(e){return thisObj.handlePanelKeyPress($(this), e);});}; tabpanel.prototype.handleTabKeyDown=function($tab, e){if (e.altKey){return true;}switch (e.keyCode){case this.keys.enter: case this.keys.space:{if (this.accordian==true){this.togglePanel($tab); e.stopPropagation(); return false;}return true;}case this.keys.left: case this.keys.up:{var thisObj=this; var $prevTab; var $newTab; if (e.ctrlKey){}else{var curNdx=this.$tabs.index($tab); if (curNdx==0){$newTab=this.$tabs.last();}else{$newTab=this.$tabs.eq(curNdx - 1);}this.switchTabs($tab, $newTab);}e.stopPropagation(); return false;}case this.keys.right: case this.keys.down:{var thisObj=this; var foundTab=false; var $newTab; var curNdx=this.$tabs.index($tab); if (curNdx==this.$tabs.length - 1){$newTab=this.$tabs.first();}else{$newTab=this.$tabs.eq(curNdx + 1);}this.switchTabs($tab, $newTab); e.stopPropagation(); return false;}case this.keys.home:{this.switchTabs($tab, this.$tabs.first()); e.stopPropagation(); return false;}case this.keys.end:{this.switchTabs($tab, this.$tabs.last()); e.stopPropagation(); return false;}}}; tabpanel.prototype.handleTabKeyPress=function($tab, e){if (e.altKey){return true;}switch (e.keyCode){case this.keys.enter: case this.keys.space: case this.keys.left: case this.keys.up: case this.keys.right: case this.keys.down: case this.keys.home: case this.keys.end:{e.stopPropagation(); return false;}case this.keys.pageup: case this.keys.pagedown:{if (!e.ctrlKey){return true;}e.stopPropagation(); return false;}}return true;}; tabpanel.prototype.handleTabClick=function($tab, e){this.$panels.attr('aria-hidden', 'true'); this.$tabs.attr('tabindex', '-1').attr('aria-selected', 'false'); $tab.attr('aria-selected', 'true'); this.$panel.find('#' + $tab.attr('aria-controls')).attr('aria-hidden', 'false'); $tab.attr('tabindex', '0'); $tab.focus(); return true;}; tabpanel.prototype.handleTabFocus=function($tab, e){$tab.addClass('focus'); return true;}; tabpanel.prototype.handleTabBlur=function($tab, e){$tab.removeClass('focus'); return true;}; tabpanel.prototype.handlePanelKeyDown=function($elem, e){if (e.altKey){return true;}switch (e.keyCode){case this.keys.esc:{e.stopPropagation(); return false;}case this.keys.left: case this.keys.up:{if (!e.ctrlKey){return true;}var $tab=$('#' + $elem.attr('aria-labelledby')); $tab.focus(); e.stopPropagation(); return false;}case this.keys.pageup:{var $newTab; if (!e.ctrlKey){return true;}var $tab=this.$tabs.filter('[aria-selected="true"]'); var curNdx=this.$tabs.index($tab); if (curNdx==0){$newTab=this.$tabs.last();}else{$newTab=this.$tabs.eq(curNdx - 1);}this.switchTabs($tab, $newTab); e.stopPropagation(); e.preventDefault(); return false;}case this.keys.pagedown:{var $newTab; if (!e.ctrlKey){return true;}var $tab=$('#' + $elem.attr('aria-labelledby')); var curNdx=this.$tabs.index($tab); if (curNdx==this.$tabs.length - 1){$newTab=this.$tabs.first();}else{$newTab=this.$tabs.eq(curNdx + 1);}this.switchTabs($tab, $newTab); e.stopPropagation(); e.preventDefault(); return false;}}; return true;}; tabpanel.prototype.handlePanelKeyPress=function($elem, e){if (e.altKey){return true;}if (e.ctrlKey && (e.keyCode==this.keys.pageup || e.keyCode==this.keys.pagedown)){e.stopPropagation(); e.preventDefault(); return false;}switch (e.keyCode){case this.keys.esc:{e.stopPropagation(); e.preventDefault(); return false;}}; return true;}; $.extend($.expr[':'],{focusable: function(element){var nodeName=element.nodeName.toLowerCase(); var tabIndex=$(element).attr('tabindex'); if (($(element)[nodeName=='area' ? 'parents' : 'closest'](':hidden').length)==true){return false;}if (!isNaN(tabIndex) && tabIndex < 0){return false;}if (/input|select|textarea|button|object/.test(nodeName)==true){return !element.disabled;}if ((nodeName=='a' || nodeName=='area')==true){return (element.href.length > 0);}return false;}});});